<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="UTF-8">
        <style media="screen" type="text/css">
            html {
                box-sizing: border-box;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
                min-width: 320px;
            }

            *,
            *::before,
            *::after {
                box-sizing: inherit;
            }

            html,
            body {
                height: 100%;
                width: 100%;
            }

            iframe {
                display: none;
                position: fixed;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                width: 100%;
                height: 100%;
            }
        </style>
    </head>
    <body>
        <h1>Hello! I am the parent page!</h1>
        <button class="send-message">Send Message to Iframe</button>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <button class="show-iframe">Show iframe</button>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <button class="show-iframe">Show iframe</button>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <p>I am some paragraph text. Look at me go!</p>
        <button class="show-iframe">Show iframe</button>
        <iframe src="http://localhost:5678"></iframe>
        <script>
            const body = document.querySelector('body');
            const iframe = document.querySelector('iframe');
            const showIframeButtons = document.querySelectorAll('.show-iframe');
            const sendMessageButton = document.querySelector('.send-message');

            const addShowIframeListeners = () => {
                showIframeButtons.forEach((button) => {
                    button.addEventListener('click', () => {
                        iframe.style.display = 'block';
                        body.style.overflow = 'hidden';
                    });
                });
            };

            const addSendMessageListener = () => {
                sendMessageButton.addEventListener('click', () => {
                    iframe.contentWindow.postMessage('message-from-parent', 'http://localhost:5678');
                });
            };

            const listenForMessagesFromIframe = () => {
                window.onmessage = (event) => {
                    if (event.origin === 'http://localhost:5678') {
                        if (event.data === 'message-from-iframe') {
                            alert('Hello, this is the parent speaking. The iframe told me to do something.');
                        }
                        if (event.data === 'close-iframe') {
                            iframe.style.display = 'none';
                            body.style.overflow = 'visible';
                        }
                    }
                };
            };

            addShowIframeListeners();
            addSendMessageListener();
            listenForMessagesFromIframe();
        </script>
    </body>
</html>
